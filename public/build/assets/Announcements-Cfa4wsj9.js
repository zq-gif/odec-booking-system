import{r as o,u as b,j as e,H as R,a as j}from"./app-ACQ607rU.js";import{A as T,b as P,a as f}from"./AuthenticatedLayout-CXUg25F3.js";import{F as L}from"./PlusIcon-SbVBdlkT.js";import{F as O}from"./MagnifyingGlassIcon-B9k_A66S.js";import{F as U}from"./ClockIcon-DUGGvEC0.js";import{F as q}from"./PencilIcon-C8t27o1q.js";import{F as B}from"./TrashIcon-B1nr8Ehs.js";import{F as y}from"./PhotoIcon-BIud8nGK.js";import"./LanguageSwitcher-eILLSAhq.js";import"./MapPinIcon-eFwDqRdf.js";import"./CalendarIcon-CTslX290.js";function Z({auth:N,announcements:v}){const[w,i]=o.useState(!1),[C,d]=o.useState(!1),[_,n]=o.useState(!1),[r,c]=o.useState(null),[x,k]=o.useState(""),[m,h]=o.useState("file"),[p,u]=o.useState("file"),s=b({title:"",message:"",photo:null,photo_url:"",is_active:!0,expires_at:""}),a=b({title:"",message:"",photo:null,photo_url:"",is_active:!0,expires_at:""}),g=v.filter(t=>t.title.toLowerCase().includes(x.toLowerCase())||t.message.toLowerCase().includes(x.toLowerCase())),D=()=>{s.reset(),h("file"),i(!0)},A=t=>{c(t),a.setData({title:t.title,message:t.message,photo:null,photo_url:"",is_active:t.is_active,expires_at:t.expires_at?t.expires_at.split("T")[0]:""}),u("file"),d(!0)},S=t=>{c(t),n(!0)},F=t=>{t.preventDefault(),console.log("Creating announcement with data:",s.data),console.log("Photo file:",s.data.photo),s.post(route("admin.announcements.store"),{forceFormData:!0,onBefore:()=>{console.log("Before submit - form data:",s.data)},onSuccess:()=>{console.log("Announcement created successfully"),i(!1),s.reset()},onError:l=>{console.error("Error creating announcement:",l)}})},E=t=>{t.preventDefault(),console.log("Editing announcement with data:",a.data),console.log("Photo file:",a.data.photo),a.post(route("admin.announcements.update",r.id),{forceFormData:!0,_method:"patch",onBefore:()=>{console.log("Before submit - form data:",a.data)},onSuccess:()=>{console.log("Announcement updated successfully"),d(!1),a.reset()},onError:l=>{console.error("Error updating announcement:",l)}})},M=()=>{j.delete(route("admin.announcements.destroy",r.id),{onSuccess:()=>{n(!1),c(null)}})},$=t=>{j.patch(route("admin.announcements.toggle",t.id))};return e.jsxs(T,{user:N.user,children:[e.jsx(R,{title:"Announcements Management"}),e.jsx("div",{className:"py-12",children:e.jsx("div",{className:"mx-auto max-w-7xl sm:px-6 lg:px-8",children:e.jsx("div",{className:"overflow-hidden bg-white shadow-sm sm:rounded-lg",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(P,{className:"mr-3 h-8 w-8 text-orange-600"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Announcements"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Manage system-wide announcements"})]})]}),e.jsxs("button",{onClick:D,className:"flex items-center rounded-lg bg-orange-600 px-4 py-2 text-white hover:bg-orange-700",children:[e.jsx(L,{className:"mr-2 h-5 w-5"}),"Create Announcement"]})]}),e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"relative",children:[e.jsx(O,{className:"absolute left-3 top-1/2 h-5 w-5 -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search announcements...",value:x,onChange:t=>k(t.target.value),className:"w-full rounded-lg border border-gray-300 py-2 pl-10 pr-4 focus:border-orange-500 focus:outline-none focus:ring-2 focus:ring-orange-500"})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500",children:"Title"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500",children:"Message"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500",children:"Photo"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500",children:"Expires"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200 bg-white",children:g.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"px-6 py-4 text-center text-gray-500",children:"No announcements found"})}):g.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:t.title}),e.jsxs("div",{className:"text-xs text-gray-500",children:["by ",t.creator?.name]})]}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"max-w-xs truncate text-sm text-gray-900",children:t.message})}),e.jsx("td",{className:"px-6 py-4",children:t.photo_path?e.jsx("img",{src:t.photo_path.startsWith("http")||t.photo_path.startsWith("/storage/")?t.photo_path:`/storage/${t.photo_path}`,alt:"Announcement",className:"h-12 w-12 rounded object-cover"}):e.jsx("span",{className:"text-xs text-gray-400",children:"No photo"})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("button",{onClick:()=>$(t),className:`inline-flex rounded-full px-2 py-1 text-xs font-semibold ${t.is_active?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:t.is_active?"Active":"Inactive"})}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:t.expires_at?e.jsxs("div",{className:"flex items-center text-xs",children:[e.jsx(U,{className:"mr-1 h-4 w-4"}),new Date(t.expires_at).toLocaleDateString()]}):e.jsx("span",{className:"text-gray-400",children:"Never"})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>A(t),className:"text-blue-600 hover:text-blue-900",children:e.jsx(q,{className:"h-5 w-5"})}),e.jsx("button",{onClick:()=>S(t),className:"text-red-600 hover:text-red-900",children:e.jsx(B,{className:"h-5 w-5"})})]})})]},t.id))})]})})]})})})}),w&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:e.jsxs("div",{className:"w-full max-w-2xl rounded-lg bg-white p-6",children:[e.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Create Announcement"}),e.jsx("button",{onClick:()=>i(!1),children:e.jsx(f,{className:"h-6 w-6"})})]}),e.jsxs("form",{onSubmit:F,children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-sm font-medium",children:"Title"}),e.jsx("input",{type:"text",value:s.data.title,onChange:t=>s.setData("title",t.target.value),className:"w-full rounded border px-3 py-2",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-sm font-medium",children:"Message"}),e.jsx("textarea",{value:s.data.message,onChange:t=>s.setData("message",t.target.value),className:"w-full rounded border px-3 py-2",rows:"4",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-sm font-medium",children:"Photo (Optional)"}),e.jsxs("div",{className:"flex gap-2 mb-3",children:[e.jsx("button",{type:"button",onClick:()=>{h("file"),s.setData("photo_url","")},className:`px-3 py-1 text-sm rounded-lg ${m==="file"?"bg-orange-600 text-white":"bg-gray-200 text-gray-700"}`,children:"Upload File"}),e.jsx("button",{type:"button",onClick:()=>{h("url"),s.setData("photo",null)},className:`px-3 py-1 text-sm rounded-lg ${m==="url"?"bg-orange-600 text-white":"bg-gray-200 text-gray-700"}`,children:"Image URL"})]}),m==="file"?e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("label",{className:"flex cursor-pointer items-center gap-2 rounded-lg border-2 border-dashed border-gray-300 px-4 py-3 hover:border-orange-400",children:[e.jsx(y,{className:"h-6 w-6 text-gray-400"}),e.jsx("span",{className:"text-sm text-gray-600",children:s.data.photo?s.data.photo.name:"Choose photo"}),e.jsx("input",{type:"file",accept:"image/*",onChange:t=>s.setData("photo",t.target.files[0]),className:"hidden"})]}),s.data.photo&&e.jsx("button",{type:"button",onClick:()=>s.setData("photo",null),className:"text-sm text-red-600 hover:text-red-800",children:"Remove"})]}):e.jsx("input",{type:"url",value:s.data.photo_url,onChange:t=>s.setData("photo_url",t.target.value),placeholder:"https://example.com/image.jpg",className:"w-full rounded border px-3 py-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-sm font-medium",children:"Expires At (Optional)"}),e.jsx("input",{type:"date",value:s.data.expires_at,onChange:t=>s.setData("expires_at",t.target.value),className:"w-full rounded border px-3 py-2"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:s.data.is_active,onChange:t=>s.setData("is_active",t.target.checked),className:"mr-2"}),e.jsx("label",{className:"text-sm font-medium",children:"Active"})]})]}),s.errors&&Object.keys(s.errors).length>0&&e.jsxs("div",{className:"mt-4 rounded bg-red-50 border border-red-200 p-3",children:[e.jsx("p",{className:"text-sm font-semibold text-red-800 mb-1",children:"Errors:"}),e.jsx("ul",{className:"list-disc list-inside text-sm text-red-700",children:Object.entries(s.errors).map(([t,l])=>e.jsx("li",{children:l},t))})]}),e.jsxs("div",{className:"mt-6 flex justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:()=>i(!1),className:"rounded bg-gray-300 px-4 py-2 hover:bg-gray-400",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:s.processing,className:"rounded bg-orange-600 px-4 py-2 text-white hover:bg-orange-700 disabled:opacity-50",children:s.processing?"Creating...":"Create"})]})]})]})}),C&&r&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:e.jsxs("div",{className:"w-full max-w-2xl rounded-lg bg-white p-6",children:[e.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Edit Announcement"}),e.jsx("button",{onClick:()=>d(!1),children:e.jsx(f,{className:"h-6 w-6"})})]}),e.jsxs("form",{onSubmit:E,children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-sm font-medium",children:"Title"}),e.jsx("input",{type:"text",value:a.data.title,onChange:t=>a.setData("title",t.target.value),className:"w-full rounded border px-3 py-2",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-sm font-medium",children:"Message"}),e.jsx("textarea",{value:a.data.message,onChange:t=>a.setData("message",t.target.value),className:"w-full rounded border px-3 py-2",rows:"4",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-sm font-medium",children:"Photo (Optional)"}),r?.photo_path&&e.jsxs("div",{className:"mb-2",children:[e.jsx("img",{src:r.photo_path.startsWith("http")||r.photo_path.startsWith("/storage/")?r.photo_path:`/storage/${r.photo_path}`,alt:"Current",className:"h-24 w-24 rounded object-cover"}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Current photo"})]}),e.jsxs("div",{className:"flex gap-2 mb-3",children:[e.jsx("button",{type:"button",onClick:()=>{u("file"),a.setData("photo_url","")},className:`px-3 py-1 text-sm rounded-lg ${p==="file"?"bg-orange-600 text-white":"bg-gray-200 text-gray-700"}`,children:"Upload File"}),e.jsx("button",{type:"button",onClick:()=>{u("url"),a.setData("photo",null)},className:`px-3 py-1 text-sm rounded-lg ${p==="url"?"bg-orange-600 text-white":"bg-gray-200 text-gray-700"}`,children:"Image URL"})]}),p==="file"?e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("label",{className:"flex cursor-pointer items-center gap-2 rounded-lg border-2 border-dashed border-gray-300 px-4 py-3 hover:border-orange-400",children:[e.jsx(y,{className:"h-6 w-6 text-gray-400"}),e.jsx("span",{className:"text-sm text-gray-600",children:a.data.photo?a.data.photo.name:"Choose new photo"}),e.jsx("input",{type:"file",accept:"image/*",onChange:t=>a.setData("photo",t.target.files[0]),className:"hidden"})]}),a.data.photo&&e.jsx("button",{type:"button",onClick:()=>a.setData("photo",null),className:"text-sm text-red-600 hover:text-red-800",children:"Remove"})]}):e.jsx("input",{type:"url",value:a.data.photo_url,onChange:t=>a.setData("photo_url",t.target.value),placeholder:"https://example.com/image.jpg",className:"w-full rounded border px-3 py-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-sm font-medium",children:"Expires At (Optional)"}),e.jsx("input",{type:"date",value:a.data.expires_at,onChange:t=>a.setData("expires_at",t.target.value),className:"w-full rounded border px-3 py-2"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:a.data.is_active,onChange:t=>a.setData("is_active",t.target.checked),className:"mr-2"}),e.jsx("label",{className:"text-sm font-medium",children:"Active"})]})]}),a.errors&&Object.keys(a.errors).length>0&&e.jsxs("div",{className:"mt-4 rounded bg-red-50 border border-red-200 p-3",children:[e.jsx("p",{className:"text-sm font-semibold text-red-800 mb-1",children:"Errors:"}),e.jsx("ul",{className:"list-disc list-inside text-sm text-red-700",children:Object.entries(a.errors).map(([t,l])=>e.jsx("li",{children:l},t))})]}),e.jsxs("div",{className:"mt-6 flex justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:()=>d(!1),className:"rounded bg-gray-300 px-4 py-2 hover:bg-gray-400",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:a.processing,className:"rounded bg-orange-600 px-4 py-2 text-white hover:bg-orange-700 disabled:opacity-50",children:a.processing?"Updating...":"Update"})]})]})]})}),_&&r&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:e.jsxs("div",{className:"w-full max-w-md rounded-lg bg-white p-6",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Delete Announcement"}),e.jsxs("p",{className:"mt-2 text-sm text-gray-600",children:['Are you sure you want to delete "',r.title,'"? This action cannot be undone.']})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{onClick:()=>n(!1),className:"rounded bg-gray-300 px-4 py-2 hover:bg-gray-400",children:"Cancel"}),e.jsx("button",{onClick:M,className:"rounded bg-red-600 px-4 py-2 text-white hover:bg-red-700",children:"Delete"})]})]})})]})}export{Z as default};
