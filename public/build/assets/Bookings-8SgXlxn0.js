import{r,u as y,j as e,H as B}from"./app-_v-2ot6z.js";import{A as L,c as M,F as U,a as E}from"./AuthenticatedLayout-lQpxwXuj.js";import{F as H}from"./MagnifyingGlassIcon-CMLGt0IV.js";import{F as P}from"./FunnelIcon-CR3CnheF.js";import{F as V}from"./UserIcon-D08ckgzL.js";import{F as j}from"./CalendarIcon-DRXE70ZZ.js";import{F as N}from"./CheckCircleIcon-CedKpVn_.js";import{F as q}from"./XCircleIcon-Vq88T1uW.js";import{F as k}from"./TrashIcon-ClizOZC9.js";import{F as O}from"./ArrowDownTrayIcon-D53LZpED.js";import"./Footer-4Vlp7FSC.js";import"./MapPinIcon-BKCODtN4.js";function z({title:d,titleId:l,...i},p){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:p,"aria-labelledby":l},i),d?r.createElement("title",{id:l},d):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"}))}const w=r.forwardRef(z);function ae({auth:d,bookings:l}){const[i,p]=r.useState(""),[o,b]=r.useState("all"),[m,v]=r.useState("all"),[s,C]=r.useState(null),[F,x]=r.useState(!1),c=y({type:"",status:""}),h=y({}),u=(t,a)=>{c.setData({type:t.type,status:a}),c.put(route("admin.bookings.update",t.id),{onSuccess:()=>{c.reset()}})},_=t=>{confirm(`Are you sure you want to delete this booking (${t.reference_number})?`)&&h.delete(route("admin.bookings.destroy",{id:t.id,type:t.type}))},R=t=>{C({receiptUrl:t.payment_receipt,bookingRef:t.reference_number,userName:t.user_name,amount:t.total_amount,paymentMethod:t.payment_method}),x(!0)},$=(t,a)=>{const n=document.createElement("a");n.href=`/storage/${t}`,n.download=`receipt_${a}.${t.split(".").pop()}`,document.body.appendChild(n),n.click(),document.body.removeChild(n)},S=t=>{const a={pending:"bg-yellow-100 text-yellow-800",confirmed:"bg-green-100 text-green-800",cancelled:"bg-red-100 text-red-800",completed:"bg-blue-100 text-blue-800"};return a[t]||a.pending},T=t=>{const a={facility:"bg-blue-100 text-blue-800",activity:"bg-purple-100 text-purple-800"};return a[t]||a.facility},g=l.filter(t=>{const a=t.reference_number.toLowerCase().includes(i.toLowerCase())||t.user_name.toLowerCase().includes(i.toLowerCase())||t.item_name.toLowerCase().includes(i.toLowerCase()),n=o==="all"||t.type===o,A=m==="all"||t.status===m;return a&&n&&A}),D=t=>new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),f=t=>t?new Date(`2000-01-01T${t}`).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}):"";return e.jsxs(L,{user:d.user,children:[e.jsx(B,{title:"Manage Bookings"}),e.jsx("div",{className:"py-12",children:e.jsx("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:e.jsx("div",{className:"bg-white overflow-hidden shadow-sm sm:rounded-lg",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Manage Bookings"}),e.jsx("p",{className:"mt-1 text-sm text-gray-600",children:"View and manage all facility and activity bookings"})]}),e.jsxs("div",{className:"mb-6 space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(H,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"text",placeholder:"Search by reference, user, or item name...",value:i,onChange:t=>p(t.target.value),className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]}),e.jsxs("div",{className:"flex flex-wrap gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(P,{className:"h-5 w-5 text-gray-400"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Filters:"})]}),e.jsxs("select",{value:o,onChange:t=>b(t.target.value),className:"px-3 py-1.5 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"all",children:"All Types"}),e.jsx("option",{value:"facility",children:"Facilities"}),e.jsx("option",{value:"activity",children:"Activities"})]}),e.jsxs("select",{value:m,onChange:t=>v(t.target.value),className:"px-3 py-1.5 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"all",children:"All Statuses"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"confirmed",children:"Confirmed"}),e.jsx("option",{value:"cancelled",children:"Cancelled"}),e.jsx("option",{value:"completed",children:"Completed"})]})]})]}),e.jsxs("div",{className:"mb-6 grid grid-cols-1 gap-4 sm:grid-cols-4",children:[e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Bookings"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:l.length})]}),e.jsxs("div",{className:"bg-yellow-50 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-yellow-800",children:"Pending"}),e.jsx("p",{className:"text-2xl font-bold text-yellow-900",children:l.filter(t=>t.status==="pending").length})]}),e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-green-800",children:"Confirmed"}),e.jsx("p",{className:"text-2xl font-bold text-green-900",children:l.filter(t=>t.status==="confirmed").length})]}),e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-blue-800",children:"Completed"}),e.jsx("p",{className:"text-2xl font-bold text-blue-900",children:l.filter(t=>t.status==="completed").length})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Booking Details"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Customer"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date & Time"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Details"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:g.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[t.type==="facility"?e.jsx(M,{className:"h-10 w-10 text-blue-500"}):e.jsx(U,{className:"h-10 w-10 text-purple-500"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:t.item_name}),e.jsx("div",{className:"text-sm text-gray-500",children:t.reference_number}),e.jsx("span",{className:`inline-flex mt-1 px-2 py-0.5 text-xs font-semibold rounded-full ${T(t.type)}`,children:t.type})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(V,{className:"h-5 w-5 text-gray-400 mr-2"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:t.user_name}),e.jsx("div",{className:"text-sm text-gray-500",children:t.user_email})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(j,{className:"h-5 w-5 text-gray-400 mr-2 mt-0.5"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-900",children:D(t.booking_date)}),t.start_time&&e.jsxs("div",{className:"text-sm text-gray-500",children:[f(t.start_time)," - ",f(t.end_time)]})]})]})}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("div",{className:"text-sm text-gray-900",children:t.type==="facility"?e.jsxs("span",{children:[t.number_of_guests," guests"]}):e.jsxs("span",{children:[t.number_of_participants," participants"]})}),t.special_requests&&e.jsxs("div",{className:"text-sm text-gray-500 mt-1",children:[e.jsx("span",{className:"font-medium",children:"Note: "}),t.special_requests.substring(0,50),t.special_requests.length>50&&"..."]})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"text-sm font-semibold text-gray-900",children:["$",t.total_amount]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${S(t.status)}`,children:t.status})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex flex-wrap gap-2",children:[t.payment_receipt&&e.jsxs("button",{onClick:()=>R(t),className:"inline-flex items-center px-3 py-1.5 bg-purple-600 text-white rounded-lg hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2 transition",title:"View payment receipt",children:[e.jsx(w,{className:"h-4 w-4 mr-1"}),"Receipt"]}),t.status==="pending"&&e.jsxs("button",{onClick:()=>u(t,"confirmed"),disabled:c.processing,className:"inline-flex items-center px-3 py-1.5 bg-green-600 text-white rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transition disabled:opacity-50",title:"Confirm booking",children:[e.jsx(N,{className:"h-4 w-4 mr-1"}),"Accept"]}),t.status==="confirmed"&&e.jsxs("button",{onClick:()=>u(t,"completed"),disabled:c.processing,className:"inline-flex items-center px-3 py-1.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition disabled:opacity-50",title:"Mark as completed",children:[e.jsx(N,{className:"h-4 w-4 mr-1"}),"Complete"]}),(t.status==="pending"||t.status==="confirmed")&&e.jsxs("button",{onClick:()=>u(t,"cancelled"),disabled:c.processing,className:"inline-flex items-center px-3 py-1.5 bg-red-600 text-white rounded-lg hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 transition disabled:opacity-50",title:"Cancel booking",children:[e.jsx(q,{className:"h-4 w-4 mr-1"}),"Cancel"]}),e.jsx("button",{onClick:()=>_(t),disabled:h.processing,className:"inline-flex items-center px-3 py-1.5 bg-gray-600 text-white rounded-lg hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 transition disabled:opacity-50",title:"Delete booking",children:e.jsx(k,{className:"h-4 w-4"})})]})})]},`${t.type}-${t.id}`))})]})}),g.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(j,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsx("h3",{className:"mt-2 text-sm font-semibold text-gray-900",children:"No bookings found"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:i||o!=="all"||m!=="all"?"Try adjusting your search or filters.":"No bookings have been made yet."})]})]})})})}),F&&s&&e.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:e.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[e.jsx("div",{className:"fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75",onClick:()=>x(!1)}),e.jsxs("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-2xl sm:w-full",children:[e.jsx("div",{className:"bg-purple-600 px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(w,{className:"h-6 w-6 text-white mr-2"}),e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Payment Receipt"})]}),e.jsx("button",{onClick:()=>x(!1),className:"text-white hover:text-gray-200 transition",children:e.jsx(E,{className:"h-6 w-6"})})]})}),e.jsxs("div",{className:"px-6 py-6",children:[e.jsx("div",{className:"mb-4 p-4 bg-gray-50 rounded-lg",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600",children:"Booking Reference"}),e.jsx("p",{className:"font-semibold text-gray-900",children:s.bookingRef})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600",children:"Customer"}),e.jsx("p",{className:"font-semibold text-gray-900",children:s.userName})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600",children:"Payment Method"}),e.jsx("p",{className:"font-semibold text-gray-900",children:s.paymentMethod==="cash"?"Cash on Arrival (10% Deposit)":"Bank Transfer"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600",children:"Total Amount"}),e.jsxs("p",{className:"font-semibold text-gray-900",children:["$",s.amount]})]})]})}),e.jsxs("div",{className:"border-2 border-gray-200 rounded-lg p-4 bg-white",children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 mb-3",children:"Receipt Image"}),s.receiptUrl?e.jsx("img",{src:`/storage/${s.receiptUrl}`,alt:"Payment Receipt",className:"max-w-full h-auto mx-auto rounded shadow-lg",style:{maxHeight:"500px"}}):e.jsx("div",{className:"text-center py-8 text-gray-500",children:"No receipt uploaded"})]})]}),e.jsxs("div",{className:"bg-gray-50 px-6 py-4 flex justify-end gap-3",children:[e.jsx("button",{onClick:()=>x(!1),className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition",children:"Close"}),s.receiptUrl&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>$(s.receiptUrl,s.bookingRef),className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",children:[e.jsx(O,{className:"h-5 w-5 mr-2"}),"Download"]}),e.jsx("a",{href:`/storage/${s.receiptUrl}`,target:"_blank",rel:"noopener noreferrer",className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition",children:"Open in New Tab"})]})]})]})]})})]})}export{ae as default};
