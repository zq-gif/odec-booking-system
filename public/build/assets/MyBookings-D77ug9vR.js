import{r as a,j as e,c as K,H as Q,a as P}from"./app-CnLqF4dd.js";import{h as U,a as X,A as ee,o as se}from"./AuthenticatedLayout-BOI9dHd6.js";import{F as q}from"./XCircleIcon-CF2ziFm0.js";import{F}from"./CheckCircleIcon-DzmJAgnG.js";import{F as C}from"./CalendarIcon-DyPmnS-e.js";import{F as S}from"./ClockIcon-CbHOHLLB.js";import{F as te}from"./MapPinIcon-DBOpXf_h.js";import{F as O}from"./UserIcon-C_jIback.js";import{a as ae,F as re}from"./PhoneIcon-0n6rCE-5.js";import{F as le}from"./TrashIcon-Cqw66Z_Q.js";import"./LanguageSwitcher-bo-WtiEz.js";function ie({title:n,titleId:o,...r},c){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:c,"aria-labelledby":o},r),n?a.createElement("title",{id:o},n):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"}))}const ne=a.forwardRef(ie);function oe({title:n,titleId:o,...r},c){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:c,"aria-labelledby":o},r),n?a.createElement("title",{id:o},n):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"}))}const ce=a.forwardRef(oe);function de({message:n,type:o="success",duration:r=3e3,onClose:c}){const[t,l]=a.useState(!0),[i,m]=a.useState(!1);a.useEffect(()=>{const h=setTimeout(()=>{m(!0),setTimeout(()=>{l(!1),c?.()},300)},r);return()=>clearTimeout(h)},[r,c]);const x=()=>{m(!0),setTimeout(()=>{l(!1),c?.()},300)};if(!t)return null;const d={success:{icon:F,bgColor:"bg-green-50",borderColor:"border-green-400",iconColor:"text-green-400",textColor:"text-green-800"},error:{icon:q,bgColor:"bg-red-50",borderColor:"border-red-400",iconColor:"text-red-400",textColor:"text-red-800"},warning:{icon:U,bgColor:"bg-yellow-50",borderColor:"border-yellow-400",iconColor:"text-yellow-400",textColor:"text-yellow-800"},info:{icon:ne,bgColor:"bg-blue-50",borderColor:"border-blue-400",iconColor:"text-blue-400",textColor:"text-blue-800"}}[o],p=d.icon;return e.jsxs("div",{className:`fixed top-4 right-4 z-50 flex items-center gap-3 min-w-[320px] max-w-md p-4 rounded-lg border-l-4 shadow-lg transition-all duration-300 ${d.bgColor} ${d.borderColor} ${i?"opacity-0 translate-x-full":"opacity-100 translate-x-0"}`,children:[e.jsx(p,{className:`h-6 w-6 flex-shrink-0 ${d.iconColor}`}),e.jsx("p",{className:`flex-1 text-sm font-medium ${d.textColor}`,children:n}),e.jsx("button",{onClick:x,className:`flex-shrink-0 ${d.textColor} hover:opacity-70 transition-opacity`,children:e.jsx(X,{className:"h-5 w-5"})})]})}function me({toasts:n,removeToast:o}){return e.jsx("div",{className:"fixed top-0 right-0 z-50 p-4 space-y-3",children:n.map(r=>e.jsx(de,{message:r.message,type:r.type,duration:r.duration,onClose:()=>o(r.id)},r.id))})}function xe(){const[n,o]=a.useState([]),r=(l,i="success",m=3e3)=>{const x=Date.now()+Math.random();o(u=>[...u,{id:x,message:l,type:i,duration:m}])};return{toasts:n,removeToast:l=>{o(i=>i.filter(m=>m.id!==l))},toast:{success:(l,i)=>r(l,"success",i),error:(l,i)=>r(l,"error",i),warning:(l,i)=>r(l,"warning",i),info:(l,i)=>r(l,"info",i)}}}function I({className:n=""}){return e.jsxs("svg",{className:`animate-spin h-5 w-5 ${n}`,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}function Ce({auth:n,bookings:o}){const[r,c]=a.useState("All"),[t,l]=a.useState(null),[i,m]=a.useState({}),[x,u]=a.useState(!1),[d,p]=a.useState(!1),[h,$]=a.useState(""),[j,R]=a.useState(""),[A,_]=a.useState(""),[M,T]=a.useState(""),[k,B]=a.useState(""),[g,f]=a.useState(!1),{toasts:z,removeToast:H,toast:b}=xe(),{flash:y}=K().props;a.useEffect(()=>{y?.success&&b.success(y.success),y?.error&&b.error(y.error)},[y]);const D=(o||[]).map(s=>({id:s.id,type:s.type||"facility",reference:s.reference_number,facility:s.item_name,date:new Date(s.booking_date).toLocaleDateString(),rawDate:s.booking_date,time:s.start_time&&s.end_time?`${s.start_time} - ${s.end_time}`:"All Day",startTime:s.start_time,endTime:s.end_time,status:s.status,image:s.item_image||"https://images.unsplash.com/photo-1559827260-dc66d52bef19?w=800&auto=format&fit=crop",contactName:n.user.name,phone:s.phone_number||"N/A",email:n.user.email,purpose:s.type==="activity"?"Activity Booking":s.purpose||"N/A",attendees:s.type==="activity"?s.number_of_participants||"N/A":s.number_of_guests||"N/A",bookedOn:new Date(s.created_at).toLocaleDateString(),totalAmount:parseFloat(s.total_amount),paymentMethod:s.payment_method||"N/A"})),V=["All","Confirmed","Pending","Completed","Cancelled"],E=r==="All"?D:D.filter(s=>s.status===r.toLowerCase()),W=s=>{m(w=>({...w,[s]:!w[s]}))},Z=s=>{l(s)},N=()=>{l(null),u(!1),p(!1),$(""),R(""),_(""),T(""),B("")},G=()=>{if(!h.trim()){b.error("Please provide a cancellation reason");return}f(!0),P.post(`/bookings/${t.id}/cancel`,{type:t.type,reason:h},{onSuccess:()=>{N(),f(!1)},onError:()=>{f(!1)}})},Y=()=>{if(!j.trim()){b.error("Please provide modification details");return}f(!0),P.post(`/bookings/${t.id}/request-modification`,{type:t.type,modification_details:j,new_date:A,new_start_time:M,new_end_time:k},{onSuccess:()=>{N(),f(!1)},onError:()=>{f(!1)}})},L=s=>{const v={confirmed:{color:"bg-green-100 text-green-800",icon:F,text:"Confirmed"},completed:{color:"bg-blue-100 text-blue-800",icon:F,text:"Completed"},pending:{color:"bg-yellow-100 text-yellow-800",icon:S,text:"Pending"},cancelled:{color:"bg-red-100 text-red-800",icon:q,text:"Cancelled"}}[s],J=v.icon;return e.jsxs("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${v.color}`,children:[e.jsx(J,{className:"h-4 w-4 mr-1"}),v.text]})};return e.jsxs(ee,{children:[e.jsx(Q,{title:"My Bookings"}),e.jsx(me,{toasts:z,removeToast:H}),e.jsx("div",{className:"py-8",children:e.jsxs("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"My Bookings"}),e.jsx("p",{className:"mt-1 text-sm text-gray-600",children:"View and manage your facility reservations"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("p",{className:"text-sm text-gray-700 mb-3",children:"Filter by status:"}),e.jsx("div",{className:"flex gap-2 flex-wrap",children:V.map(s=>e.jsx("button",{onClick:()=>c(s),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${r===s?"bg-blue-600 text-white":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50"}`,children:s},s))})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Bookings"}),E.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(C,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No bookings found"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:r==="All"?"You haven't made any bookings yet.":`No ${r.toLowerCase()} bookings.`})]}):e.jsx("div",{className:"space-y-4",children:E.map(s=>e.jsxs("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:[e.jsxs("div",{className:"flex items-center p-4",children:[e.jsx("img",{src:s.image,alt:s.facility,className:"w-20 h-20 rounded-lg object-cover"}),e.jsxs("div",{className:"flex-1 ml-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:s.facility}),e.jsxs("div",{className:"flex items-center text-sm text-gray-600 mt-1",children:[e.jsx(C,{className:"h-4 w-4 mr-1"}),e.jsx("span",{className:"mr-4",children:s.date}),e.jsx(S,{className:"h-4 w-4 mr-1"}),e.jsx("span",{children:s.time})]})]}),e.jsxs("div",{className:"text-right mr-4",children:[L(s.status),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Ref: ",s.reference]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("button",{onClick:()=>W(s.id),className:"flex items-center text-sm text-gray-600 hover:text-gray-900",children:[e.jsx(se,{className:`h-4 w-4 mr-1 transition-transform ${i[s.id]?"rotate-180":""}`}),i[s.id]?"Hide":"Show"," Details"]}),e.jsx("button",{onClick:()=>Z(s),className:"px-4 py-1.5 text-sm text-gray-700 border border-gray-300 rounded hover:bg-gray-50",children:"View Full Details"})]})]}),i[s.id]&&e.jsx("div",{className:"px-4 pb-4 pt-2 bg-gray-50 border-t border-gray-200",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600",children:"Purpose"}),e.jsx("p",{className:"font-medium text-gray-900",children:s.purpose})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600",children:"Attendees"}),e.jsx("p",{className:"font-medium text-gray-900",children:s.attendees})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600",children:"Payment Method"}),e.jsx("p",{className:"font-medium text-gray-900",children:s.paymentMethod})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600",children:"Total Amount"}),e.jsxs("p",{className:"font-medium text-gray-900",children:["RM ",s.totalAmount.toFixed(2)]})]})]})})]},s.id))})]})]})}),t&&!x&&!d&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex justify-between items-center",children:[e.jsx("div",{children:L(t.status)}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Reference"}),e.jsx("p",{className:"font-semibold text-gray-900",children:t.reference})]})]}),e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:t.facility}),e.jsx("img",{src:t.image,alt:t.facility,className:"w-full h-48 object-cover rounded-lg mb-6"}),e.jsxs("div",{className:"grid grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{className:"flex items-start",children:[e.jsx(C,{className:"h-5 w-5 text-gray-400 mr-3 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Date"}),e.jsx("p",{className:"font-medium text-gray-900",children:t.date})]})]}),e.jsxs("div",{className:"flex items-start",children:[e.jsx(S,{className:"h-5 w-5 text-gray-400 mr-3 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Time"}),e.jsx("p",{className:"font-medium text-gray-900",children:t.time})]})]}),e.jsxs("div",{className:"flex items-start",children:[e.jsx(te,{className:"h-5 w-5 text-gray-400 mr-3 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Facility"}),e.jsx("p",{className:"font-medium text-gray-900",children:t.facility})]})]}),e.jsxs("div",{className:"flex items-start",children:[e.jsx(O,{className:"h-5 w-5 text-gray-400 mr-3 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Purpose"}),e.jsx("p",{className:"font-medium text-gray-900",children:t.purpose})]})]})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-6 mb-6",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Contact Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-start",children:[e.jsx(O,{className:"h-5 w-5 text-gray-400 mr-3 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Name"}),e.jsx("p",{className:"font-medium text-gray-900",children:t.contactName})]})]}),e.jsxs("div",{className:"flex items-start",children:[e.jsx(ae,{className:"h-5 w-5 text-gray-400 mr-3 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Phone"}),e.jsx("p",{className:"font-medium text-gray-900",children:t.phone})]})]}),e.jsxs("div",{className:"flex items-start col-span-2",children:[e.jsx(re,{className:"h-5 w-5 text-gray-400 mr-3 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Email"}),e.jsx("p",{className:"font-medium text-gray-900",children:t.email})]})]})]})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-6 mb-6",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Additional Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Number of Attendees"}),e.jsx("p",{className:"font-medium text-gray-900",children:t.attendees})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Booked On"}),e.jsx("p",{className:"font-medium text-gray-900",children:t.bookedOn})]})]})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Payment Information"}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:"Total Amount"}),e.jsxs("p",{className:"text-xl font-bold text-gray-900",children:["RM ",t.totalAmount.toFixed(2)]})]})]})]}),e.jsxs("div",{className:"sticky bottom-0 bg-gray-50 border-t border-gray-200 px-6 py-4 flex justify-end gap-3",children:[e.jsx("button",{onClick:N,className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-100 font-medium",children:"Close"}),t.status==="confirmed"&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>p(!0),className:"inline-flex items-center px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium",children:[e.jsx(ce,{className:"h-5 w-5 mr-2"}),"Modify Booking"]}),e.jsxs("button",{onClick:()=>u(!0),className:"inline-flex items-center px-6 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 font-medium",children:[e.jsx(le,{className:"h-5 w-5 mr-2"}),"Cancel Booking"]})]})]})]})}),x&&t&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg max-w-md w-full",children:[e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Cancel Booking"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Are you sure you want to cancel this booking? This action cannot be undone. Cancellations must be made at least 24 hours in advance."}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Reason for cancellation ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{value:h,onChange:s=>$(s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:"4",placeholder:"Please provide a reason for cancellation...",required:!0})]})]}),e.jsxs("div",{className:"bg-gray-50 px-6 py-4 flex justify-end gap-3",children:[e.jsx("button",{onClick:()=>u(!1),className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-100",disabled:g,children:"Go Back"}),e.jsx("button",{onClick:G,className:"inline-flex items-center px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed",disabled:g||!h.trim(),children:g?e.jsxs(e.Fragment,{children:[e.jsx(I,{className:"mr-2"}),"Cancelling..."]}):"Confirm Cancellation"})]})]})}),d&&t&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg max-w-lg w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Request Booking Modification"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Submit a modification request for your booking. Our team will review and contact you shortly. Requests must be submitted at least 48 hours in advance."}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Modification Details ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{value:j,onChange:s=>R(s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:"4",placeholder:"Describe what you'd like to change...",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"New Date (Optional)"}),e.jsx("input",{type:"date",value:A,onChange:s=>_(s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",min:new Date().toISOString().split("T")[0]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"New Start Time (Optional)"}),e.jsx("input",{type:"time",value:M,onChange:s=>T(s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"New End Time (Optional)"}),e.jsx("input",{type:"time",value:k,onChange:s=>B(s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]})]})]}),e.jsxs("div",{className:"bg-gray-50 px-6 py-4 flex justify-end gap-3",children:[e.jsx("button",{onClick:()=>p(!1),className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-100",disabled:g,children:"Cancel"}),e.jsx("button",{onClick:Y,className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",disabled:g||!j.trim(),children:g?e.jsxs(e.Fragment,{children:[e.jsx(I,{className:"mr-2"}),"Submitting..."]}):"Submit Request"})]})]})})]})}export{Ce as default};
